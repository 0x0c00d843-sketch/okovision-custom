services:
  okovision:
    image: okovision:latest
    container_name: okovision-app
    restart: unless-stopped
    
    environment:
      - BDD_IP=${BDD_IP:-192.168.1.200}
      - BDD_USER=${BDD_USER:-okovision}
      - BDD_PASS=${BDD_PASS:-changeme}
      - BDD_SCHEMA=${BDD_SCHEMA:-okovision}
      - CHAUDIERE_IP=${CHAUDIERE_IP:-192.168.1.100}
      - CHAUDIERE_PORT=${CHAUDIERE_PORT:-4321}
      - TC_REF=${TC_REF:-18}
      - POIDS_PELLET=${POIDS_PELLET:-350}
      - SURFACE_MAISON=${SURFACE_MAISON:-130}
      - TIMEZONE=${TIMEZONE:-Europe/Paris}
      - HAS_SILO=${HAS_SILO:-1}
      - SILO_SIZE=${SILO_SIZE:-5000}
      - ASHTRAY=${ASHTRAY:-1000}
      - OKOVISION_LANG=${OKOVISION_LANG:-fr}
      
    volumes:
      - okovision-logs:/var/www/okovision/_logs
      - okovision-tmp:/var/www/okovision/_tmp
      
    ports:
      - "8080:80"
    
    networks:
      - okovision-net
    
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/api.php"]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 30s

volumes:
  okovision-logs:
  okovision-tmp:

networks:
  okovision-net:
